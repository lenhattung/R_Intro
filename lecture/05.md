# BÀI 4: CẤU TRÚC DỮ LIỆU NHIỀU CHIỀU: MATRIX VÀ LIST

## 1. Đặt vấn đề: Tại sao Vector là chưa đủ?

Trong các bài trước, chúng ta đã làm việc với **Vector** (dãy số hoặc chuỗi). Tuy nhiên, dữ liệu thực tế trong Khoa học Dữ liệu thường phức tạp hơn:

1. **Dữ liệu dạng bảng:** Bảng điểm sinh viên, bảng doanh thu theo tháng, dữ liệu ảnh (pixel). Chúng có hàng và cột  Cần **Matrix**.
2. **Dữ liệu hỗn hợp:** Một hồ sơ bệnh án bao gồm: Tên (chữ), Tuổi (số), Lịch sử khám (bảng), Kết quả xét nghiệm (True/False). Vector hay Matrix không thể chứa lẫn lộn các kiểu này  Cần **List**.

---

## 2. Ma trận (Matrix)

### 2.1. Ma trận trong thực tế phân tích dữ liệu

Matrix là cấu trúc dữ liệu **2 chiều** (hàng và cột).

* **Đặc điểm cốt lõi:** Tính **đồng nhất (Homogeneous)**. Tất cả phần tử bắt buộc phải cùng kiểu (tất cả là số, hoặc tất cả là chữ).
* **Ứng dụng:**
* Xử lý ảnh (ảnh đen trắng là một ma trận các con số từ 0-255).
* Đại số tuyến tính trong Machine Learning (nhân ma trận trọng số).
* Lưu trữ dữ liệu dạng bảng đơn giản.



### 2.2. Khởi tạo Ma trận

Cú pháp: `matrix(data, nrow, ncol, byrow)`

**Ví dụ 1: Tạo ma trận số học cơ bản**

```{r}
# Tạo ma trận 2 hàng, 3 cột, điền số theo cột (mặc định)
mat_col <- matrix(1:6, nrow = 2, ncol = 3)
print(mat_col)

# Tạo ma trận điền số theo hàng (thường dùng hơn vì tự nhiên với mắt người)
mat_row <- matrix(1:6, nrow = 2, ncol = 3, byrow = TRUE)
print(mat_row)

```

**Ví dụ 2: Ứng dụng quản lý điểm số (Đặt tên cho hàng/cột)**
Việc đặt tên (`rownames`, `colnames`) giúp truy xuất dữ liệu minh bạch hơn là chỉ dùng số thứ tự.

```{r}
# Dữ liệu điểm của 3 sinh viên cho 4 môn học
grades <- matrix(
  c(8.5, 9.0, 7.5, 8.8,  # Điểm SV 1
    9.2, 7.8, 8.5, 9.0,  # Điểm SV 2
    7.6, 8.2, 8.9, 8.5), # Điểm SV 3
  nrow = 3, ncol = 4, byrow = TRUE
)

# Gán nhãn để dữ liệu có ý nghĩa
rownames(grades) <- c("Le Nhat Tung", "Nguyen Van A", "Le Thi C")
colnames(grades) <- c("Toán", "Văn", "Anh", "Tin")

print(grades)

```

### 2.3. Truy cập và trích xuất dữ liệu (Indexing)

Tư duy truy cập: `[Hàng, Cột]`

```{r}
# 1. Lấy điểm môn Văn (cột 2) của Nguyen Van A (hàng 2)
print(grades[2, 2])

# 2. Lấy toàn bộ bảng điểm của Le Nhat Tung (Hàng 1)
print(grades[1, ])

# 3. Lấy điểm môn Tin học của cả lớp (Cột 4)
# Cách dùng chỉ số
print(grades[, 4])
# Cách dùng tên cột (trực quan hơn)
print(grades[, "Tin"])

# 4. Lấy điểm Toán và Văn của 2 sinh viên đầu tiên (Slicing)
print(grades[1:2, c("Toán", "Văn")])

```

### 2.4. Các phép toán thống kê trên Ma trận

Trong Data Science, chúng ta thường cần tính toán tổng hợp theo chiều dọc (theo biến số) hoặc chiều ngang (theo đối tượng).

```{r}
# Tính điểm trung bình từng môn học (Theo cột)
colMeans(grades)

# Tính điểm tổng kết của từng sinh viên (Theo hàng)
rowMeans(grades)

# Vẽ biểu đồ nhanh so sánh điểm trung bình các môn
barplot(colMeans(grades), col="lightblue", main="Điểm trung bình các môn")

```

---

## 3. Danh sách (List)

### 3.1. List - "Chiếc balo" vạn năng

Nếu Vector/Matrix là chiếc hộp chỉ đựng được một loại đồ vật, thì **List** là chiếc balo có thể chứa mọi thứ: vector, matrix, dataframe, và thậm chí là một list khác.

* **Ứng dụng thực tế:**
* Kết quả trả về của các mô hình thống kê (Model Linear Regression trả về 1 list chứa: hệ số, sai số, công thức, v.v...).
* Lưu trữ cấu trúc JSON từ API (web scraping).
* Hồ sơ cá nhân tổng hợp.



### 3.2. Khởi tạo List

```{r}
# Một hồ sơ sinh viên điển hình
student_profile <- list(
  info = c("Nguyen Van A", "K15_CNTT"),  # Vector chữ
  age = 20,                              # Số nguyên
  grades = c(8.5, 9.0, 7.5),             # Vector số thực
  passed = TRUE,                         # Logical
  details = matrix(1:4, nrow=2)          # Thậm chí chứa cả Matrix
)

```

### 3.3. Truy cập dữ liệu trong List (Rất quan trọng)

Đây là phần sinh viên hay nhầm lẫn nhất.

* `$` : Dùng tên để lấy nội dung (Phổ biến nhất).
* `[[ ]]`: Trả về chính **nội dung** của phần tử (Lấy món đồ ra khỏi hộp).
* `[ ]`: Trả về một **List con** (Cắt cái hộp nhỏ từ hộp lớn, vẫn còn vỏ hộp).

```{r}
# Cách 1: Dùng $ (Khuyên dùng vì dễ đọc)
print(student_profile$grades)

# Cách 2: Dùng [[ ]] để lấy giá trị thực sự để tính toán
avg_score <- mean(student_profile[[3]]) 
print(avg_score)

# Cách 3: Thêm dữ liệu mới vào List
student_profile$email <- "vana@university.edu.vn"
print(names(student_profile)) # Kiểm tra các thành phần

```

---

## 4. Tổng kết so sánh (Cheat Sheet)

| Tiêu chí | Vector | Matrix | List |
| --- | --- | --- | --- |
| **Số chiều** | 1 chiều | 2 chiều (Hàng, Cột) | Đa chiều/Linh hoạt |
| **Kiểu dữ liệu** | Đồng nhất (Chỉ 1 loại) | Đồng nhất (Chỉ 1 loại) | **Hỗn hợp** (Mọi loại) |
| **Truy cập** | `[i]` | `[hàng, cột]` | `[[i]]` hoặc `$name` |
| **Ví dụ** | Dãy điểm số | Bảng điểm, Ảnh số | Kết quả Model AI, JSON |

---

## 5. Bài tập thực hành (Lab)

### Bài 1: Phân tích doanh số (Matrix)

Tạo một ma trận `sales` lưu doanh số của 3 sản phẩm (iPhone, Samsung, Xiaomi) trong 3 tháng đầu năm (T1, T2, T3).

1. Tạo ma trận với dữ liệu tùy ý (ví dụ: từ 100 đến 500).
2. Đặt tên hàng là tên sản phẩm, tên cột là các tháng.
3. Tính tổng doanh thu của từng sản phẩm trong cả quý (`rowSums`).
4. Tính doanh thu trung bình của từng tháng (`colMeans`).

### Bài 2: Quản lý nhân sự (List)

Tạo một List tên `employee` chứa thông tin của một giảng viên:

1. `name`: Tên giảng viên.
2. `subjects`: Vector chứa tên 3 môn dạy (ví dụ: "Python", "R", "ML").
3. `schedule`: Ma trận 2x3 thể hiện số tiết dạy (2 ngày, 3 ca).
4. **Yêu cầu:** Dùng lệnh truy cập để in ra môn học thứ 2 mà giảng viên này dạy.

---
